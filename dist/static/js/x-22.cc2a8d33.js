(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x-22"],{1493:function(t,e,a){},"19ea":function(t,e,a){"use strict";var i=a("dff3"),s=a.n(i);s.a},"229e":function(t,e,a){"use strict";var i=a("383a"),s=a.n(i);s.a},2446:function(t,e,a){"use strict";var i=a("cebc"),s=a("51e6"),r=a("4183"),n=0;e["a"]={data:function(){return{isLoading:!0,pullLoading:!1,finished:!1,imgIsLoading:!1,scrollCheck:!1,finishedTip:"没有更多数据了",loadingTip:"加载中...",listData:[],pullParamsDefault:{page_num:1,page_limit:20,need_pagination:1,page_serial:""},pullParams:{}}},methods:{initPullList:function(){this.pullParams.page_serial="",this.pullParams.page_num=1,this.finished=!1,this.pullLoading=!1},onRefresh:function(){this.initPullList(),window.scrollTo(0,10)},onScrollToLower:function(){var t=this;if(!this.pullLoading)if(this.finished)this.pullLoading=!1;else{this.pullLoading=!0;var e=n;n++,this.pullModel(Object(i["a"])({},this.pullParamsDefault,this.pullParams,{showLoading:!1}),function(a){t.$hideLoading(),t.isLoading=!1,t.pullLoading=!1,n-1>e||(s["a"].msf&&r["a"].stopRefresh(),"function"===typeof t.afterPull&&t.afterPull(a),t.dealData(a))},function(e){t.$hideLoading(),t.pullLoading=!1,s["a"].msf&&r["a"].stopRefresh()},this)}},pullModel:function(){},dealData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.pullParams.page_num,a=void 0===e?1:e,i=t.data,s=void 0===i?{}:i;this.pullParams.page_serial=s.page_serial||"";var r=s.list||[],n=s.total_page>a;if(1!==a||r.length||(n=!1),1===a&&(this.listData=[]),n&&(this.pullParams.page_num+=1),this.finished=!n,"function"===typeof this.dealList&&r.length){var o=this.dealList(r)||[];if(!o)return void this.$showToast("处理数据返回格式有问题");r=o.filter(function(t){return t})}this.listData=this.listData.concat(r),"function"===typeof this.afterPullData&&this.afterPullData(t)}}}},"383a":function(t,e,a){},"7f10":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"default-page"},[a("div",{staticClass:"top-img",style:t.styles}),a("span",{directives:[{name:"show",rawName:"v-show",value:t.fontItem.desc,expression:"fontItem.desc"}],staticClass:"desc",style:t.fontStyle,domProps:{innerHTML:t._s(t.fontItem.desc)}})])},s=[],r={name:"DefaultPage",props:{imgItem:Object,fontItem:Object},computed:{styles:function(){var t=this.$props.imgItem,e=t.src,a=t.width,i=t.height;return{backgroundImage:e?"url('".concat(e,"')"):null,width:"".concat(a/100,"rem"),height:"".concat(i/100,"rem")}},fontStyle:function(){var t=this.$props.fontItem,e=t.size,a=t.color,i=t.width;return{fontSize:e?"".concat(e/100,"rem"):"12px",color:a||"#ccc",width:"".concat(i/100,"rem")}}},methods:{}},n=r,o=(a("c52c"),a("2877")),c=Object(o["a"])(n,i,s,!1,null,"6e735df8",null);e["a"]=c.exports},"9d17":function(t,e,a){t.exports=a.p+"static/img/order_expired.b764e167.png"},c52c:function(t,e,a){"use strict";var i=a("1493"),s=a.n(i);s.a},cf2ab:function(t,e,a){"use strict";a.r(e);var i,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order-page"},[a("ul",{staticClass:"order-nav line1px",class:{bottom:t.isNavClass,"is-header":t.isHeader}},t._l(t.navData,function(e,i){return a("li",{key:e.name+i,class:{action:i==t.currentNavIndex},on:{click:function(a){return t.navClickEvent(e.type,i)}}},[a("span",[t._v(t._s(e.name))])])}),0),a("vue-scroll",{staticClass:"page-scroll",attrs:{finished:t.finished,listLen:t.listData.length,isLoading:t.isLoading,finishedTip:t.finishedTip,"immediate-check":t.scrollCheck},on:{onScrollToLower:t.onScrollToLower},model:{value:t.pullLoading,callback:function(e){t.pullLoading=e},expression:"pullLoading"}},[a("div",{staticClass:"order-list"},t._l(t.listData,function(t,e){return a("order-item",{key:"order_"+e+t.oid,attrs:{item:t}})}),1),a("div",{staticClass:"not-order",attrs:{slot:"not-data"},slot:"not-data"},[a("DefaultPage",{attrs:{imgItem:t.imgItem,fontItem:t.fontItem}})],1)])],1)},r=[],n=(a("a481"),a("c5f6"),a("cebc")),o=a("bd86"),c=(a("7f7f"),a("2446")),l=a("365c"),d=a("79bb"),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-item",attrs:{"data-type":"detail"},on:{click:t.gotoNext}},[i("div",{staticClass:"product-info"},[i("div",{staticClass:"jzimg img-box"},[i("img",{attrs:{src:t.item.src,alt:"image"}})]),i("div",{staticClass:"product-text"},[i("p",{staticClass:"product-title ellipsis"},[t._v(t._s(t.item.title))]),i("div",{staticClass:"brand-name ellipsis"},[t._v(t._s(t.item.brandName))]),i("div",{staticClass:"price-or-status"},[i("span",{staticClass:"price"},[t._v("￥"+t._s(t._f("price")(t.item.curPrice)))]),5===t.item.orderStatusCode||6===t.item.orderStatusCode?i("small",{staticClass:"refund"},[t._v(t._s(t.item.statusText))]):t._e(),i("span",{staticClass:"note-status"},[t._v(t._s(t.item.noteStatus))])])]),4===t.item.orderStatusCode?i("div",{staticClass:"order-tag"},[i("img",{attrs:{src:a("9d17"),alt:""}})]):t._e()]),5!==t.item.orderStatusCode&&6!==t.item.orderStatusCode?i("div",{staticClass:"order-status"},[2==t.item.status?i("p",{staticClass:"order-time"},[t._v("\n      "+t._s(t.item.statusText)+" "+t._s(t._f("formatDate")(t.item.timeText,"Y-M-D"))+"\n    ")]):t._e(),3==t.item.status?i("p",{staticClass:"order-time"},[t._v("\n      "+t._s(t.item.statusText)+" "+t._s(t._f("formatDate")(t.item.timeText,"Y-M-D H:F:S"))+"\n    ")]):t._e(),1===t.item.orderStatusCode?i("span",{staticClass:"order-btn",attrs:{"data-type":"detail"},on:{click:function(e){return e.stopPropagation(),t.gotoNext(e)}}},[t._v("去使用")]):2===t.item.orderStatusCode?i("span",{staticClass:"order-btn",attrs:{"data-type":"publish"},on:{click:function(e){return e.stopPropagation(),t.gotoNext(e)}}},[t._v("发布笔记")]):3===t.item.orderStatusCode?i("small",{attrs:{"data-type":"article"},on:{click:function(e){return e.stopPropagation(),t.gotoNext(e)}}},[t._v("查看笔记")]):t._e()]):t._e()])},f=[],p=a("a516"),m=a("51e6"),h=a("4183"),v={name:"order-item",props:{item:{type:Object,required:!0}},data:function(){return{isMSF:m["a"].msf}},methods:{gotoNext:function(t){var e=t.currentTarget.dataset.type;switch(e){case"detail":this.$forward("order-detail",{id:this.item.oid});break;case"article":if(this.item.video_id)if(this.isMSF){var a=p["storage"].get("userInfo")||{},i=this;h["a"].getNativePath({success:function(t){var e=t.data.pathList;e.indexOf("video-list")>=0?i.$forward("video-list",{id:i.item.article_id,type:1,member:a.id}):i.$forward("article",{id:i.item.article_id})}})}else this.$forward("article",{id:this.item.article_id});else this.$forward("article",{id:this.item.article_id});break;case"publish":this.$forward("publish",{order_id:this.item.oid,activity_id:this.item.activity_id});break;default:}}}},g=v,_=(a("229e"),a("2877")),b=Object(_["a"])(g,u,f,!1,null,"072a82de",null),C=b.exports,y=a("42a5"),k=a("1172"),w=a("2f62"),x=a("7f10"),S=a("b80e"),L=a.n(S),P={name:"order",mixins:[c["a"]],components:(i={},Object(o["a"])(i,d["c"].name,d["c"]),Object(o["a"])(i,C.name,C),Object(o["a"])(i,"DefaultPage",x["a"]),i),data:function(){return{isNavClass:!1,currentNavIndex:this.$route.query.index||0,currentType:this.$route.query.type||0,navData:[{name:"全部订单",type:0},{name:"待使用",type:1},{name:"待分享笔记",type:4},{name:"退款单",type:3}],imgItem:{width:166.6,height:133.3,src:L.a},fontItem:{desc:"吃点好的很有必要，赶紧去下单吧～"}}},created:function(){this.getData(),this.getOrderNoticepop()},computed:{isHeader:function(){return!!m["a"].msf}},watch:{$route:function(t,e){var a=t.query,i=a.index,s=void 0===i?0:i,r=a.type,n=void 0===r?0:r;this.currentNavIndex=s,this.currentType=n,k["a"].setScrollTop(this.$el,0),this.getData()}},mounted:function(){var t=this;this.$nextTick(function(){var e=t;m["a"].msf&&(h["a"].enableRefresh(),h["a"].onPullRefresh({success:function(t){k["a"].setScrollTop(e.$el,0),e.getData()}})),Object(y["b"])(t.$el,"scroll",function(e){var a=k["a"].getScrollTop(t.$el);0==a?t.isNavClass=!1:t.isNavClass||(t.isNavClass=!0)})})},beforeDestroy:function(){Object(y["a"])(this.$el,"scroll",function(){}),m["a"].msf&&(h["a"].disableRefresh(),h["a"].offPullRefresh(function(t){}))},methods:Object(n["a"])({},Object(w["b"])(["setShareMask","setOrderShadeData"]),{navClickEvent:function(t,e){this.currentNavIndex=e,this.$forward("order",{replace:!0,type:t,index:e})},getData:function(){this.$showLoading(),this.initPullList(),this.pullParams.filter_type=this.currentType,this.onScrollToLower()},pullModel:function(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];l["a"].orderlist.apply(this,e)},dealList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(function(e){var a=t.getOrderStatus(e);return Object(n["a"])({oid:e.id,activity_id:e.activity_id,article_id:e.article_id,src:e.item_pic,title:e.item_name,curPrice:e.amount,noteStatus:t.noteStatusText(e.article_status,e.status),brandName:e.branch_name,distance:1212},a)})},getOrderStatus:function(t){var e=0,a="",i=t.expire_time;switch(t.status){case 1:break;case 2:e=1,a="有效期至";break;case 3:a="已使用",i=t.redeem_time,e=1==t.article_status?2:5==t.article_status?2:3;break;case 4:e=4,a="已过期";break;case 5:e=6,a="退款成功";break;case 6:break;case 7:e=5,a="退款中";break;default:}return{status:t.status,orderStatusCode:e,statusText:a,timeText:i}},getOrderNoticepop:function(){var t=this;l["a"].orderNoticepop({},function(e){var a=e.data;a.is_pop&&(t.setShareMask({isShow:!0,type:4}),t.setOrderShadeData(a.pop_data),t.getOrderNoticeack())},function(t){})},getOrderNoticeack:function(){l["a"].orderNoticeack({},function(t){},function(t){})},noteStatusText:function(t,e){var a="",i=this.$version._version,s=Number(i.replace(/[.]/g,""));if(s>=210){if(3==e)switch(t){case 1:a="笔记待发布";break;case 2:a="笔记审核中";break;case 4:a="笔记未通过审核";break;case 5:a="笔记待发布";break;default:a="";break}}else if(3==e)switch(t){case 1:a="笔记待发布";break;case 2:a="";break;default:a="";break}return a}})},D=P,T=(a("19ea"),Object(_["a"])(D,s,r,!1,null,"f3b4dae8",null));e["default"]=T.exports},dff3:function(t,e,a){}}]);