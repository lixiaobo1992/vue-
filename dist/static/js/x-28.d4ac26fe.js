(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x-28"],{1493:function(t,i,a){},"1c14":function(t,i,a){"use strict";var e,s=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"product-box"},[a("div",{staticClass:"product-list"},t._l(t.productListData,function(i,e){return a("product-item",{key:"product_"+e+i.pid,attrs:{item:i,index:e},on:{btnEvent:t.btnEvent}})}),1)])},n=[],c=(a("c5f6"),a("cebc")),r=a("bd86"),o=(a("7f7f"),a("3892"),a("450f")),l=a.n(o),u=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"product-item",class:{"small-item":2===t.item.classType},on:{click:t.gotoProductDetail}},[a("div",{staticClass:"product-item-box"},[a("div",{staticClass:"img-box jzimg"},[a("img",{staticClass:"product-img",attrs:{src:t.item.src,alt:"image"}})]),a("div",{staticClass:"product-info clearfix"},[a("p",{staticClass:"max-line-2 product-name"},[a("i",{directives:[{name:"show",rawName:"v-show",value:t.item.is_new,expression:"item.is_new"}],staticClass:"new"},[t._v("新品")]),t._v(t._s(t.item.title)+"\n      ")]),a("div",{staticClass:"product-address"},[a("p",{staticClass:"ellipsis"},[t._v(t._s(t.item.brandName))]),a("span",[t._v(t._s(t._f("distance")(t.item.distance)))])]),a("div",{staticClass:"price-box"},[a("p",[a("span",{staticClass:"price",class:{lessPrice:t.isLessPrice,gray:1==t.item.btnStatus.btnState}},[t.isLessPrice?[t._v("已砍"+t._s(t.item.bargained))]:[t._v("¥"+t._s(t._f("price")(t.item.curPrice)))]],2),a("del",[t._v("¥"+t._s(t._f("price")(t.item.delPrice)))])]),a("span",{staticClass:"bargain-btn",class:{cheng:2==t.item.btnStatus.btnState,lv:3==t.item.btnStatus.btnState,lan:4==t.item.btnStatus.btnState},on:{click:function(i){return i.stopPropagation(),t.handleBtnClick(i)}}},[t._v("\n          "+t._s(t.item.btnStatus.btnText)+"\n          "),t.item.isload?a("mt-spinner",{staticClass:"spinnerStyle",attrs:{type:3,color:"#ffffff",size:20}}):t._e()],1)])])])])},d=[],h=(a("c6f8"),a("e8c9")),p=a.n(h),f={name:"product-item",props:{item:{type:Object,required:!0},index:Number},components:Object(r["a"])({},p.a.name,p.a),data:function(){return{isLessPrice:!1}},watch:{item:function(t,i){var a=this,e=t.isload,s=t.is_bargained,n=i.is_bargained;e||!n&&s&&(this.isLessPrice=!0,setTimeout(function(){a.isLessPrice=!1},1500))}},methods:{handleBtnClick:function(){this.$emit("btnEvent",Object.assign({},this.item,{index:this.index}))},gotoProductDetail:function(){this.$forward("product-detail",{id:this.item.pid})}}},g=f,m=(a("2253"),a("2877")),b=Object(m["a"])(g,u,d,!1,null,"3e351817",null),_=b.exports,v=a("4183"),L=a("11a9"),w=a("51e6"),y=a("ed08"),x=a("2f62"),P=a("4360"),S=a("365c"),D=a("e380"),O={name:"product-list",props:{listData:{type:Array,default:function(){return[]}}},components:(e={},Object(r["a"])(e,l.a.name,l.a),Object(r["a"])(e,_.name,_),e),data:function(){return{productListData:[],isMSF:w["a"].msf,tongdunFingerprintStatus:!1,blackBox:"",sessionId:""}},watch:{listData:function(t,i){var a=this;setTimeout(function(){a.productListData=a.dealList(t)},0)}},computed:Object(c["a"])({},Object(x["d"])({logged:function(t){return t.user.logged},userInfo:function(t){return t.user.userInfo}})),created:function(){this.productListData=this.dealList(this.listData);var t=this;this.isMSF&&v["a"].getAppConfig({success:function(i){var a=i.data;t.tongdunFingerprintStatus=a.tongdunFingerprint,t.tongdunFingerprintStatus&&v["a"].getSystemInfo({success:function(i){var a=i.data;t.blackBox=a.blackBox}})}})},methods:Object(c["a"])({},Object(x["b"])(["setShareMask"]),{dealList:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return i.map(function(i){return t.filterItemData(i)})},filterItemData:function(t){var i=this.getBtnState(t);return{pid:t.activity_id,src:t.item_pic,title:t.item_name,is_new:t.is_new,curPrice:t.current_price,delPrice:t.market_price,brandName:t.branch_name,distance:t.distance||0,bargainCount:t.bargain_count||0,is_bargained:t.is_bargained,classType:"shop-detail"===this.$route.name?2:1,btnStatus:i}},getBtnState:function(t){var i="已抢光",a=1;return t.is_sold?(a=1,i="已抢光"):Number(t.current_price)<=Number(t.floor_price)?(i="马上抢",a=4):t.is_bargained?(i="再砍",a=3):(i="砍价",a=2),{btnText:i,btnState:a}},btnEvent:function(t){var i=t.btnStatus,a=t.pid,e="index:".concat(t.index,",value:{goodId:").concat(a,",goodBargainStatus:").concat(i,"}");if(D["a"].event("c_good_cheap",e),this.logged)switch(i.btnState){case 2:this.bargain(t);break;case 3:this.againBargain(t);break;case 1:case 4:case 5:this.goBooking(t);break;default:}else w["a"].msf?v["a"].login({success:function(t){var i=t.data;P["a"].commit("SET_USERINFO",i)},fail:function(t){L["a"].showToast("登录失败，请重试！")}}):this.$forward("login")},bargain:function(t){var i=this,a=this;this.$showLoading("正在砍价中..."),t.isload=!0,this.productListData.splice(t.index,1,Object.assign({},t)),S["a"].bargain({activity_id:t.pid,showLoading:!1,black_box:this.sessionId?"":this.blackBox,afs_session_id:this.sessionId},function(e){i.$hideLoading();var s=e.data.reduce,n=void 0===s?0:s,c=i.filterItemData(e.data);c.isload=!1,c.is_bargained=!0,c.bargained=n,c.index=t.index,a.productListData.splice(t.index,1,Object.assign({},c)),i.sessionId=""},function(e){if(i.$hideLoading(),t.isload=!1,91220003==e.errno||91220013==e.errno||91220004==e.errno||91220014==e.errno){var s="已抢光",n=1;91220003==e.errno?(n=5,s="已下架"):91220013!=e.errno&&91220014!=e.errno||(n=4,s="马上抢"),t.btnStatus={btnText:s,btnState:n}}else(9125103==e.errno&&i.isMSF||9125102==e.errno&&i.isMSF)&&v["a"].securityGuard({success:function(i){var e=i.data;e&&e.sessionID&&(a.sessionId=e.sessionID,a.bargain(t),a.sessionId="")}});i.productListData.splice(t.index,1,Object.assign({},t))})},againBargain:function(t){if(D["a"].event("c_product_share"),w["a"].wechat||w["a"].msf){var i=t.delPrice,a=t.curPrice,e=t.title,s=t.src,n=t.brandName,r=t.pid,o={title:e,weixin_timeline:{title:"最低1折起，快来砍价！".concat(n,":").concat(e)},desc:"原价¥".concat(Object(y["c"])(i,100),"， 现在只要¥").concat(Object(y["c"])(a,100),"!快来帮我，最低只要1折起！"),link:"".concat(location.origin,"/bargain?id=").concat(r,"&publisher=").concat(this.userInfo.id||0),imgUrl:s};w["a"].wechat?(this.setShareMask({isShow:!0,type:2}),v["a"].setShare(o)):w["a"].msf&&v["a"].showShare(Object(c["a"])({},o,{url:location.href,success:function(t){},onlySelectChannel:["weixin","weixin_timeline","copy_link"]}))}else this.$showToast({message:"您的客户端不支持分享，手动分享此页面吧～",duration:3e3})},goBooking:function(t){var i="index:".concat(t.index,",value:{goodId:").concat(t.pid,"}");D["a"].event("c_good",i),this.$forward("product-detail",{id:t.pid})}})},j=O,I=(a("f12b"),Object(m["a"])(j,s,n,!1,null,"1a9c7986",null));i["a"]=I.exports},2253:function(t,i,a){"use strict";var e=a("8a9d"),s=a.n(e);s.a},2446:function(t,i,a){"use strict";var e=a("cebc"),s=a("51e6"),n=a("4183"),c=0;i["a"]={data:function(){return{isLoading:!0,pullLoading:!1,finished:!1,imgIsLoading:!1,scrollCheck:!1,finishedTip:"没有更多数据了",loadingTip:"加载中...",listData:[],pullParamsDefault:{page_num:1,page_limit:20,need_pagination:1,page_serial:""},pullParams:{}}},methods:{initPullList:function(){this.pullParams.page_serial="",this.pullParams.page_num=1,this.finished=!1,this.pullLoading=!1},onRefresh:function(){this.initPullList(),window.scrollTo(0,10)},onScrollToLower:function(){var t=this;if(!this.pullLoading)if(this.finished)this.pullLoading=!1;else{this.pullLoading=!0;var i=c;c++,this.pullModel(Object(e["a"])({},this.pullParamsDefault,this.pullParams,{showLoading:!1}),function(a){t.$hideLoading(),t.isLoading=!1,t.pullLoading=!1,c-1>i||(s["a"].msf&&n["a"].stopRefresh(),"function"===typeof t.afterPull&&t.afterPull(a),t.dealData(a))},function(i){t.$hideLoading(),t.pullLoading=!1,s["a"].msf&&n["a"].stopRefresh()},this)}},pullModel:function(){},dealData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.pullParams.page_num,a=void 0===i?1:i,e=t.data,s=void 0===e?{}:e;this.pullParams.page_serial=s.page_serial||"";var n=s.list||[],c=s.total_page>a;if(1!==a||n.length||(c=!1),1===a&&(this.listData=[]),c&&(this.pullParams.page_num+=1),this.finished=!c,"function"===typeof this.dealList&&n.length){var r=this.dealList(n)||[];if(!r)return void this.$showToast("处理数据返回格式有问题");n=r.filter(function(t){return t})}this.listData=this.listData.concat(n),"function"===typeof this.afterPullData&&this.afterPullData(t)}}}},"31ba":function(t,i,a){"use strict";a.r(i);var e,s=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"page-product is-header"},[a("vue-scroll",{staticClass:"page-scroll",attrs:{finished:t.finished,listLen:t.listData.length,isLoading:t.isLoading,finishedTip:t.finishedTip,"immediate-check":t.scrollCheck},on:{onScrollToLower:t.onScrollToLower},model:{value:t.pullLoading,callback:function(i){t.pullLoading=i},expression:"pullLoading"}},[a("div",{staticClass:"tab-cont-box"},[a("ul",{staticClass:"tab-box"},t._l(t.tabsList,function(i,e){return a("li",{key:e,staticClass:"tab-text-box",class:{"select-tab-border":t.list_type==i.tab_type},attrs:{"data-type":i.tab_type},on:{click:t.tabSelect}},[a("span",{staticClass:"tab-text"},[t._v(t._s(i.tab_name))]),a("img",{staticClass:"tab-img",attrs:{src:i.tab_img}})])}),0)]),a("product-list",{attrs:{listData:t.currentProductList}}),a("DefaultPage",{directives:[{name:"show",rawName:"v-show",value:!t.listData.length,expression:"!listData.length"}],attrs:{imgItem:t.imgItem,fontItem:t.fontItem}})],1)],1)},n=[],c=a("cebc"),r=a("bd86"),o=(a("7f7f"),a("2f62")),l=a("2446"),u=a("365c"),d=a("79bb"),h=a("1c14"),p=a("2ddd"),f=a("ed08"),g=a("7f10"),m=a("2294"),b=a.n(m),_={name:"product-tab-list",mixins:[l["a"]],components:(e={},Object(r["a"])(e,d["c"].name,d["c"]),Object(r["a"])(e,h["a"].name,h["a"]),Object(r["a"])(e,"DefaultPage",g["a"]),e),data:function(){return{tabsList:[{tab_name:"新品来袭",tab_img:"https://img.mishifeng.com/FjMW1iUkLbxf-Z6ykUX87_UtkwcU",tab_type:1},{tab_name:"底价秒杀",tab_img:"https://img.mishifeng.com/FggJKM3vP3IXGn7A4kSROrIhOd6z",tab_type:2}],list_type:this.$route.query.type||"",tags:[{id:0,name:"全部"}],productList:{},currentTag:{id:0,name:"全部"},value:"",imgItem:{src:b.a,width:250,height:200},fontItem:{width:240,desc:1==this.$route.query.type?"一大波新品正在赶来的路上，敬请期待～":"底价商品将不定时在这里出现，抢到就是赚到！"}}},beforeCreate:function(){},created:function(){var t=this;this.$showLoading(),this.getGeo({name:"probe-shop",success:function(i){t.getData()},fail:function(i){t.getData()}})},computed:Object(c["a"])({},Object(o["d"])({location:function(t){return t.location}}),{currentProductList:function(){return Object(p["d"])(this.productList)?this.productList["tag"+this.currentTag.id].list:[]}}),methods:Object(c["a"])({},Object(o["b"])(["getGeo","setSelectCity","setSelectAddress"]),{getData:function(){this.$showLoading(),this.initPullList(),this.pullParams.category_id=this.currentTag.id,this.pullParams.list_type=this.list_type;var t=this.location.selectAddress;Object(p["d"])(t)&&(this.pullParams.lng=t.lng,this.pullParams.lat=t.lat),this.onScrollToLower()},pullModel:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];u["a"].activityList.apply(this,i)},afterPullData:function(t){if(Object(p["d"])(this.productList)){var i=t.data.list,a=void 0===i?[]:i,e=this.productList["tag"+this.currentTag.id];e=Object(f["a"])(e),e.list=this.value?a:e.list.concat(a),e.page_num=this.pullParams.page_num,e.finished=this.finished,e.page_serial=this.pullParams.page_serial,this.$set(this.productList,"tag"+this.currentTag.id,e)}else if(0===this.currentTag.id){for(var s={},n=0;n<this.tags.length;n++){var c=this.tags[n],r={list:[],page_num:1,finished:!1,page_serial:""};0==n&&(r.list=this.listData,r.page_num=this.pullParams.page_num,r.finished=this.finished,r.page_serial=this.pullParams.page_serial),s["tag"+c.id]=r}this.productList=s}},gotoNext:function(t){var i=t.currentTarget.dataset.type;this.$forward(i)},tabSelect:function(t){var i=t.currentTarget.dataset.type;this.list_type!=i&&(this.list_type=i,this.productList={},this.getData())}})},v=_,L=(a("5a50"),a("2877")),w=Object(L["a"])(v,s,n,!1,null,"953489fc",null);i["default"]=w.exports},"5a50":function(t,i,a){"use strict";var e=a("ac6a1"),s=a.n(e);s.a},"7f10":function(t,i,a){"use strict";var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"default-page"},[a("div",{staticClass:"top-img",style:t.styles}),a("span",{directives:[{name:"show",rawName:"v-show",value:t.fontItem.desc,expression:"fontItem.desc"}],staticClass:"desc",style:t.fontStyle,domProps:{innerHTML:t._s(t.fontItem.desc)}})])},s=[],n={name:"DefaultPage",props:{imgItem:Object,fontItem:Object},computed:{styles:function(){var t=this.$props.imgItem,i=t.src,a=t.width,e=t.height;return{backgroundImage:i?"url('".concat(i,"')"):null,width:"".concat(a/100,"rem"),height:"".concat(e/100,"rem")}},fontStyle:function(){var t=this.$props.fontItem,i=t.size,a=t.color,e=t.width;return{fontSize:i?"".concat(i/100,"rem"):"12px",color:a||"#ccc",width:"".concat(e/100,"rem")}}},methods:{}},c=n,r=(a("c52c"),a("2877")),o=Object(r["a"])(c,e,s,!1,null,"6e735df8",null);i["a"]=o.exports},"8a9d":function(t,i,a){},ac6a1:function(t,i,a){},c52c:function(t,i,a){"use strict";var e=a("1493"),s=a.n(e);s.a},d930:function(t,i,a){},f12b:function(t,i,a){"use strict";var e=a("d930"),s=a.n(e);s.a}}]);