(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["x-8"],{"0bef":function(i,e,t){"use strict";t.r(e);var a=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{ref:"page",staticClass:"comment-page"},[t("vue-scroll",{staticClass:"page-scroll",attrs:{finished:i.finished,listLen:i.listData.length,isLoading:i.isLoading,imgIsLoading:i.imgIsLoading,finishedTip:i.finishedTip,"immediate-check":i.scrollCheck},on:{onScrollToLower:i.onScrollToLower},model:{value:i.pullLoading,callback:function(e){i.pullLoading=e},expression:"pullLoading"}},[t("div",{staticClass:"comments-list"},i._l(i.listData,function(e,a){return t("CommentItem",{key:a,attrs:{item:e,likesStatus:i.likeStatus},on:{onEnterReply:i.onEnterReply}})}),1),t("div",{staticClass:"add-comment"},[t("AddComment",{attrs:{userAvatar:i.userAvatar,articleId:i.articleId,userType:i.userType,replyPid:i.replyPid,userId:i.userId,placeholder:i.placeholderString},on:{onEnter:i.onEnter}})],1)])],1)},s=[],n=(t("6762"),t("2fdb"),t("75fc")),r=t("bd86"),l=(t("7f7f"),t("b232")),o=t("d6de"),u=t("2446"),d=t("79bb"),c=t("365c"),f=t("7676"),h=t.n(f),p=t("bc05"),m={mixins:[u["a"]],components:Object(r["a"])({AddComment:o["a"],CommentItem:l["a"]},d["c"].name,d["c"]),data:function(){return{userAvatar:"",comments:[],listData:[],articleId:0,userId:0,userType:!1,userinfos:{},article_info:{},finishedTip:"",imgIsLoading:!0,likes_comment:[],userinfo:{},likeStatus:!0,placeholderString:"写下你的想法吧",replyPid:0}},methods:{refresh:function(){this.initPullList(),this.pullParams.id=this.$route.query.id||2,this.onScrollToLower()},pullModel:function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];c["a"].commentList.apply(this,e)},dealList:function(){var i=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.userinfos,a=this.likes_comment,s=this.userinfo;return e.map(function(e){return{avatar:t[e.user_id]?t[e.user_id].avatar_url:h.a,userName:t[e.user_id]?t[e.user_id].nickname:"觅食蜂",content:e.content,time:Object(p["a"])(e.created_at),id:e.user_id,likesNum:e.likes_num,isPraise:i.isPraise(e.id,a,s),replyPid:e.id,arctileId:e.article_id,replayList:e.sub_comment.list.map(function(e){return{user:{user_id:e.user_id,nickname:(t[e.user_id]||{}).nickname||"觅食蜂",isAuthor:e.user_id==i.article_info.user_id,content:e.content},replyTo:{user_id:e.reply_to,nickname:(t[e.reply_to]||{}).nickname||"觅食蜂",isAuthor:e.reply_to==i.article_info.user_id}}})||[],count:e.sub_comment.total_cnt,userType:1==t[e.user_id].quality_user}})},afterPull:function(i){var e=i.data,t=this;if(e.userinfo&&e.userinfo.avatar){var a=[e.userinfo.avatar,e.userinfos,e.article_info,e.likes_comment,e.userinfo];t.userAvatar=a[0],t.userinfos=a[1],t.article_info=a[2],t.likes_comment=a[3],t.userinfo=a[4],t.userType=1==e.quality_user}},onEnter:function(i){if(this.placeholderString=i.placeholder,this.userId=i.userId,i.type)this.refresh();else{var e=Date.parse(new Date)/1e3,t={avatar:i.avatar,userName:i.nickname,content:i.content,time:Object(p["a"])(e)};this.listData=[t].concat(Object(n["a"])(this.listData))}},onEnterReply:function(i){var e=this;1==i.type?(this.placeholderString=i.placeholder,this.userId=i.user_id||0,this.replyPid=i.reply_pid||0):setTimeout(function(){e.refresh()},1e3)},isPraise:function(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;return!!(e.includes(i)&&t.user_id>0)}},created:function(){this.articleId=parseInt(this.$route.query.id),this.refresh()}},g=m,_=(t("7554"),t("2877")),v=Object(_["a"])(g,a,s,!1,null,"96254fd0",null);e["default"]=v.exports},2446:function(i,e,t){"use strict";var a=t("cebc"),s=t("51e6"),n=t("4183"),r=0;e["a"]={data:function(){return{isLoading:!0,pullLoading:!1,finished:!1,imgIsLoading:!1,scrollCheck:!1,finishedTip:"没有更多数据了",loadingTip:"加载中...",listData:[],pullParamsDefault:{page_num:1,page_limit:20,need_pagination:1,page_serial:""},pullParams:{}}},methods:{initPullList:function(){this.pullParams.page_serial="",this.pullParams.page_num=1,this.finished=!1,this.pullLoading=!1},onRefresh:function(){this.initPullList(),window.scrollTo(0,10)},onScrollToLower:function(){var i=this;if(!this.pullLoading)if(this.finished)this.pullLoading=!1;else{this.pullLoading=!0;var e=r;r++,this.pullModel(Object(a["a"])({},this.pullParamsDefault,this.pullParams,{showLoading:!1}),function(t){i.$hideLoading(),i.isLoading=!1,i.pullLoading=!1,r-1>e||(s["a"].msf&&n["a"].stopRefresh(),"function"===typeof i.afterPull&&i.afterPull(t),i.dealData(t))},function(e){i.$hideLoading(),i.pullLoading=!1,s["a"].msf&&n["a"].stopRefresh()},this)}},pullModel:function(){},dealData:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.pullParams.page_num,t=void 0===e?1:e,a=i.data,s=void 0===a?{}:a;this.pullParams.page_serial=s.page_serial||"";var n=s.list||[],r=s.total_page>t;if(1!==t||n.length||(r=!1),1===t&&(this.listData=[]),r&&(this.pullParams.page_num+=1),this.finished=!r,"function"===typeof this.dealList&&n.length){var l=this.dealList(n)||[];if(!l)return void this.$showToast("处理数据返回格式有问题");n=l.filter(function(i){return i})}this.listData=this.listData.concat(n),"function"===typeof this.afterPullData&&this.afterPullData(i)}}}},"2d4c":function(i,e,t){},7554:function(i,e,t){"use strict";var a=t("2d4c"),s=t.n(a);s.a}}]);